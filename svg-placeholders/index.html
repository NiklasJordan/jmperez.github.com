<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta http-equiv=Accept-CH content="DPR, Viewport-Width, Width"><title>Using SVG as placeholders — More Image Loading Techniques - José M. Pérez</title><meta name=description content="Web Performance Optimisation by lazy-loading images using SVGs as placeholders, representing edges, shapes and silhouettes."><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover"><link rel=author href="https://plus.google.com/107456024651797783420"/><link rel=alternate type=application/rss+xml title="Jose M. Perez" href=https://jmperezperez.com/feed.xml><meta name=twitter:card content=summary_large_image><meta name=twitter:url content="https://jmperezperez.com/svg-placeholders/" property=og:url><meta name=twitter:title content="Using SVG as placeholders — More Image Loading Techniques - José M. Pérez" property=og:title><meta name=twitter:description content="Web Performance Optimisation by lazy-loading images using SVGs as placeholders, representing edges, shapes and silhouettes." property=og:description><meta name=twitter:site content=@jmperezperez><meta property=og:image content=https://jmperezperez.com/assets/images/posts/svg-placeholders/jmperez-composition-primitive.jpg><meta name=twitter:image content=https://jmperezperez.com/assets/images/posts/svg-placeholders/jmperez-composition-primitive.jpg><meta property=fb:app_id content=1702266270006013><meta property=fb:pages content="1639848659664211"/><link rel=canonical href="https://jmperezperez.com/svg-placeholders/"/><style>a,a:hover{color:#2a7cb2}.post::after,hr{display:block;clear:both}#page,.main-header,.videoWrapper{position:relative}.code,code,pre{letter-spacing:0}.code-wrap pre,pre{white-space:pre-wrap}.caption,.main-header,.me,.pagination,.pagination a,footer{text-align:center}*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;border:none;font:inherit;margin:0;padding:0;vertical-align:baseline}button,input{background:0 0}body{background:#fff;color:#555;font-family:Georgia,Times;font-weight:300;font-style:normal;font-size:19px;line-height:1.725;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-text-size-adjust:100%}blockquote,em{font-style:italic}@media(max-width:800px){body{font-size:17px}}@media(max-width:600px){body{font-size:15px}}h1,h2,h3,h4,h5{color:#212121;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:600;font-size:1em;line-height:1.3;margin-bottom:1em}h2,h3,h4,h5{margin-top:2em}#menu a,.button{font-weight:400}.post ol,.post ul,amp-video,amp-vimeo,amp-youtube,iframe,p,video{margin:0 0 1em}.quote,blockquote,ol,ul{margin:0 0 15px}twitterwidget{margin-bottom:1em!important}a{font-weight:inherit;text-decoration:none;transition:color .15s ease-out,border-bottom-color .15s ease-out}p a{border-bottom:1px solid #eee}p a:hover{border-bottom-color:#212121}strong{font-weight:700}h2,h3{font-weight:400}h1{font-size:1.7em}h2{color:#444;font-size:1.6em}h3{color:#666;font-size:1.4em}h4{font-size:1.18em}h5{font-size:1em}a h1,a h2,a h3,a h4,a h5{transition:color .15s ease-out}a:hover h1,a:hover h2,a:hover h3,a:hover h4,a:hover h5{color:#3498db}blockquote{border-left:2px solid #ccc;padding-left:20px}ol,ul{padding-left:25px}ul{list-style:square}ol{list-style:decimal}hr{background:#eee;color:#eee;height:2px;margin:30px auto;width:50%}.main-header,.post,.post .svg-container object{width:100%}code,pre{color:#333;font-family:Courier,Menlo,Monaco;font-size:.8em;overflow-x:auto}.author,.main-header{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}pre{padding:.8em 1em}code{margin:0}.post::after{content:''}.main-header{background-color:#005689;overflow:hidden;padding:1em}#menu{display:inline-block;margin:1px 0}#menu a{color:#fff;font-size:14px;margin-left:15px;padding:20px 10px;text-transform:uppercase}@media(max-width:500px){#menu a{margin-left:10px;padding:10px 5px}}#menu a:first-child{margin-left:0}#menu a[aria-current]{font-weight:700}#page{margin:0 auto;max-width:40em;padding:3em 2em}.videoWrapper{height:0;margin-bottom:1em;padding-bottom:56.25%;padding-top:25px}.videoWrapper amp-youtube,.videoWrapper iframe{height:100%;left:0;position:absolute;top:0;width:100%}.wrapper{border-top:2px solid #eee;padding:3em 0}.wrapper:first-child{border-top:none;padding-top:5%}.posts-list h2{margin-top:0}.post{display:block}.post div[itemprop=articleBody]>p:first-child{color:#333}.post li{margin-bottom:.5em}.post p img{border:1px solid #eee;display:block;max-width:100%}.post img+.caption{padding-top:5px}.post .svg-container{margin-bottom:5%;max-width:100%;text-align:center}video{height:auto;max-width:100%}.pagination a{min-width:30px;max-height:30px}footer{border-top:1px dashed #ddd;padding:2em}.timing-stats{font-size:.7em;padding:.35em}.button{background-color:#fff;border:1px solid #555;border-radius:20px;color:#555;display:inline-block;font-size:13px;line-height:10px;padding:10px 20px;transition:background-color .15s ease-out}.button:hover{background-color:#3498db;border-color:transparent;color:#fff}.button.inactive{background-color:#ccc;color:#fff}.search-goog input{border:2px solid #ddd;padding:10px}.search-goog input[type=submit]{background-color:#ddd;cursor:pointer}@media only screen and (max-width:768px){#page,.wrapper{margin:0;max-width:100%;padding:1.5em;width:100%}.wrapper{padding:10% 0}.wraper::after{clear:both;content:'';display:block}.post{margin:0 auto;max-width:640px}}.outscreen{height:1px;left:-1000px;overflow:hidden;position:absolute;top:auto;width:1px}.callout{border:1px solid #eee;border-left-color:#777;border-left-width:5px;border-radius:3px;font-size:90%;padding:20px;margin:20px 0}.author{font-size:.8em;margin-bottom:2em}.author .name{line-height:1.5;padding-top:.35em}.bd,.media{overflow:hidden;zoom:1}.media .img{float:left}.avatar-img{border-radius:100%;height:3.5em;margin-right:.5em;width:3.5em}.highlight{border:1px solid #eee;margin-bottom:1em;overflow-x:auto}.code{background:#fff;color:#333;display:block;overflow-x:auto}.code .comment,.code .meta{color:#969896}.code .emphasis,.code .quote,.code .string,.code .strong,.code .template-variable,.code .variable{color:#df5000}.code .keyword,.code .selector-tag,.code .type{color:#a71d5d}.code .attribute,.code .bullet,.code .literal,.code .symbol{color:#0086b3}.code .name,.code .section{color:#63a35c}.code .tag{color:#333}.code .attr,.code .selector-attr,.code .selector-class,.code .selector-id,.code .selector-pseudo,.code .title{color:#795da3}.code .addition{background-color:#eaffea;color:#55a532}.code .deletion{background-color:#ffecec;color:#bd2c00}.code .link{text-decoration:underline}.caption{display:block;font-size:.8em}.codepen-aspect-ratio>iframe{height:100%;position:absolute;width:100%}.twitter-tweet{margin-left:auto;margin-right:auto}.twitter-tweet::after{content:"";display:block;padding-bottom:20px;width:100%}.me{max-width:20em;margin:0 auto .5em}.me h1{margin-bottom:0}</style><link rel=amphtml href="/svg-placeholders/amp/"><meta name=theme-color content=#005689><link rel=manifest href=/manifest.json><link rel=alternate hreflang=en href="/svg-placeholders/"/><link rel=alternate hreflang=es href="/es/svg-placeholders/"/></head><body><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-39254352-1","auto"),ga("send","pageview");</script><header class=main-header><nav id=menu><a href="/">Blog</a> <a href="/projects/">Projects</a> <a href="/talks/">Speaking</a> <a href="/about-me/">About</a></nav></header><div id=page><article class=wrapper><div class=post><header><script type=application/ld+json>{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Using SVG as placeholders — More Image Loading Techniques",
  
  "description": "Web Performance Optimisation by lazy-loading images using SVGs as placeholders, representing edges, shapes and silhouettes.",
  
  "mainEntityOfPage":{
      "@type":"WebPage",
      "@id":"https://jmperezperez.com/svg-placeholders/"
  },
  "datePublished": "2017-10-29T21:30:00.000Z",
  "dateModified": "2018-03-19T15:24:36.014Z",
  
  "image": {
    "@type": "ImageObject",
    "url": "https://jmperezperez.com/assets/images/posts/svg-placeholders/jmperez-composition-primitive.jpg",
    "width" : "2040",
    "height" : "1024"
  },
  
  "author": {
      "@type": "Person",
      "name": "Jose M. Perez",
      "url": "https://jmperezperez.com",
      "sameAs": [
        "http://www.linkedin.com/in/jmperezperez",
        "https://twitter.com/jmperezperez"
      ]
  },
  "publisher": {
      "@type": "Organization",
      "name": "Jose M. Perez's Blog"
      
      ,
      "logo": {
        "@type": "ImageObject",
        "url": "https://jmperezperez.com/assets/images/logo.png",
        "width": 600,
        "height": 60
      }
      
  }
}</script><div class="media author"><div class=img><a href="/about-me/"><img src=https://res.cloudinary.com/jmperez/image/upload/w_120,f_auto,c_scale/v1519156883/profile_ysrm5y.jpg class=avatar-img alt="" height=53 width=53 sizes=53px></a></div><div class=bd><address class=name itemprop=author itemscope itemtype=https://schema.org/Person><a href="/about-me/" itemprop=name>José M. Pérez</a></address><meta class=post-data itemprop=datePublished content=2017-10-29T21:30:00.000Z>October 29 2017</div></div><h1>Using SVG as placeholders — More Image Loading Techniques</h1></header><p>I’m passionate about image performance optimisation and making images load fast on the web. One of the most interesting areas of exploration is placeholders: what to show when the image hasn’t loaded yet.</p><p>During the last days I have come across some loading techniques that use SVG, and I would like to describe them in this post.</p><p><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:684,f_auto,c_scale/v1509278557/jmperez-composition-primitive_j8zyfn.jpg sizes="(max-width: 768px) 100vw, 684px" alt="Example of a SVG generated using 10 and 100 triangles based on a bitmap image"> <small class=caption>Generating SVGs from images can be used for placeholders. Keep reading!</small></p><a id=more></a><p>In this post we will go through these topics:</p><ul><li>Overview of different types of placeholders</li><li>SVG-based placeholders (edges, shapes and silhouettes)</li><li>Automating the process.</li></ul><h3 id=Overview-of-different-types-of-placeholders><a href=#Overview-of-different-types-of-placeholders class=headerlink title="Overview of different types of placeholders"></a>Overview of different types of placeholders</h3><p>In the past <a href=/lazy-loading-images>I have written about placeholders and lazy-load of images</a>, and also <a href="https://www.youtube.com/watch?v=szmVNOnkwoU" target=_blank rel=noopener>talked about it</a>. When doing lazy-loading of images it’s a good idea to think about what to render as a placeholder, since it can have a big impact in user’s perceived performance. In the past I described several options:</p><p><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:684,f_auto,c_scale/v1509278557/placeholder-options_vtwp6b.png sizes="(max-width: 768px) 100vw, 684px"> <small class=caption>Several strategies to fill the area of an image before it loads.</small></p><ul><li><strong>Keeping the space empty for the image</strong>: In a world of responsive design, this prevents content from jumping around. Those layout changes are bad from a user’s experience point of view, but also for performance. The browser is forced to do layout re calculations every time it fetches the dimensions of an image, leaving space for it.</li><li><strong>Placeholder</strong>: Imagine that we are displaying a user’s profile image. We might want to display a silhouette in the background. This is shown while the main image is loaded, but also when that request failed or when the user didn’t set any profile picture at all. These images are usually vector-based, and due to their small size are a good candidate to be inlined.</li><li><strong>Solid colour</strong>: Take a colour from the image and use it as the background colour for the placeholder. This can be the dominant colour, the most vibrant… The idea is that it is based on the image you are loading and should help making the transition between no image to image loaded smoother.</li><li><strong>Blurry image</strong>: Also called blur-up technique. You render a tiny version of the image and then transition to the full one. The initial image is tiny both in pixels and kBs. To remove artifacts the image is scaled up and blurred. I have written previously about this on <a href=/medium-image-progressive-loading-placeholder>How Medium does progressive image loading</a>, <a href=/webp-placeholder-images>Using WebP to create tiny preview images</a>, and <a href=/more-progressive-image-loading>More examples of Progressive Image Loading</a>.</li></ul><p>Turns out there are many other variations and lots of smart people are developing other techniques to create placeholders.</p><p>One of them is having gradients instead of solid colours. The gradients can create a more accurate preview of the final image, with very little overhead (increase in payload).</p><p><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:684,f_auto,c_scale,w_1368/v1509278575/gradient-background_jyymty.jpg sizes="(max-width: 768px) 100vw, 684px" alt="Using gradients as backgrounds. Screenshot from Gradify"> <small class=caption>Using gradients as backgrounds. Screenshot from Gradify, which is not online anymore. Code <a href=https://github.com/fraser-hemp/gradify target=_blank rel=noopener>on GitHub</a>.</small></p><p>Another technique is using SVGs based on the image, which is getting some traction with recent experiments and hacks.</p><h3 id=SVG-based-placeholders><a href=#SVG-based-placeholders class=headerlink title="SVG-based placeholders"></a>SVG-based placeholders</h3><p>We know SVGs are ideal for vector images. In most cases we want to load a bitmap one, so the question is how to vectorise an image. Some options are using edges, shapes and areas.</p><h4 id=Edges><a href=#Edges class=headerlink title=Edges></a>Edges</h4><p>In <a href=/drawing-edges-svg>a previous post</a> I explained how to find out the edges of an image and create an animation. My initial goal was to try to draw regions, vectorising the image, but I didn’t know how to do it. I realised that using the edges could also be innovative and I decided to animate them creating a “drawing” effect.</p><div class=codepen-aspect-ratio style="margin-bottom: 10px; padding-bottom: 100%; position: relative; width: 100%"><iframe id=cp_embed_oogqdp src="//codepen.io/jmperez/embed/oogqdp?height=600&theme-id=0&slug-hash=oogqdp&default-tab=result" scrolling=no frameborder=no height=600 allowtransparency=true allowfullscreen=true class=cp_embed_iframe data-amp-width=600 style="width: 600; overflow: hidden"></iframe></div><h4 id=Shapes><a href=#Shapes class=headerlink title=Shapes></a>Shapes</h4><p>SVG can also be used to draw areas from the image instead of edges/borders. In a way, we would vectorise a bitmap image to create a placeholder.</p><p>Back in the days I tried to do something similar with triangles. You can see the result in my talks <a href=/cssconfau16/#/45>at CSSConf</a> and <a href=/renderconf17/#/46>Render Conf</a>.</p><div class=codepen-aspect-ratio style="margin-bottom: 10px; padding-bottom: 74%; position: relative; width: 100%"><iframe id=cp_embed_BmaWmQ src="//codepen.io/jmperez/embed/BmaWmQ?height=444&theme-id=0&slug-hash=BmaWmQ&default-tab=result" scrolling=no frameborder=no height=444 allowtransparency=true allowfullscreen=true class=cp_embed_iframe data-amp-width=600 style="width: 600; overflow: hidden"></iframe></div><p>The codepen above is a proof of concept of a SVG-based placeholder composed of 245 triangles. The generation of the triangles is based on <a href=https://en.wikipedia.org/wiki/Delaunay_triangulation target=_blank rel=noopener>Delaunay triangulation</a> using <a href=https://github.com/possan/polyserver target=_blank rel=noopener>Possan’s polyserver</a>. As expected, the more triangles the SVG uses, the bigger the file size.</p><h4 id=Primitive-and-SQIP-a-SVG-based-LQIP-technique><a href=#Primitive-and-SQIP-a-SVG-based-LQIP-technique class=headerlink title="Primitive and SQIP, a SVG-based LQIP technique"></a>Primitive and SQIP, a SVG-based LQIP technique</h4><p>Tobias Baldauf has been working on another Low-Quality Image Placeholder technique using SVGs called <a href=https://github.com/technopagan/sqip target=_blank rel=noopener>SQIP</a>. Before digging into SQIP itself I will give an overview of <a href=https://github.com/fogleman/primitive target=_blank rel=noopener>Primitive</a>, a library on which SQIP is based.</p><p>Primitive is quite fascinating and I definitely recommend you to check it out. It converts a bitmap image into a SVG composed of overlapping shapes. Its small size makes it suitable for inlining it straight into the page. One less roundtrip, and a meaningful placeholder within the initial HTML payload.</p><p>Primitive generates an image based on shapes like triangles, rectangles and circles (and a few others). In every step it adds a new one. The more steps, the resulting image looks closer to the original one. If your output is SVG it also means the size of the output code will be larger.</p><p>In order to understand how Primitive works, I ran it through a couple of images. I generated SVGs for the pictures using 10 shapes and 100 shapes:</p><div><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:228,f_auto,c_scale,w_500/v1509367394/pexels-photo-281184-square-10.svg_ifiu2z.png sizes="(max-width: 768px) 33vw, 228px" alt="Processing a picture through Primitive using 10 shapes" style=width:32%;float:left;margin-right:2%;padding-bottom:10px><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:228,f_auto,c_scale,w_500/v1509367394/pexels-photo-281184-square-100.svg_tkr8el.png sizes="(max-width: 768px) 33vw, 228px" alt="Processing a picture through Primitive using 100 shapes" style=width:32%;float:left;margin-right:2%;padding-bottom:10px><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:228,f_auto,c_scale,w_500/v1509367395/pexels-photo-281184-square_tuhvso.jpg sizes="(max-width: 768px) 33vw, 228px" alt="Original picture" style=width:32%;float:left;padding-bottom:10px></div><p><small class=caption>Processing <a href=/assets/images/posts/svg-placeholders/pexels-photo-281184-square.jpg>this picture</a> using Primitive, using <a href=/assets/images/posts/svg-placeholders/pexels-photo-281184-square-10.svg>10 shapes</a> and <a href=/assets/images/posts/svg-placeholders/pexels-photo-281184-square-100.svg>100 shapes</a>.</small></p><div><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:228,f_auto,c_scale,w_500/v1509367394/pexels-photo-618463-square-10.svg_aeonon.png sizes="(max-width: 768px) 33vw, 228px" alt="Processing a picture through Primitive using 10 shapes" style=width:32%;float:left;margin-right:2%;padding-bottom:10px><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:228,f_auto,c_scale,w_500/v1509367394/pexels-photo-618463-square-100.svg_t6pwcv.png sizes="(max-width: 768px) 33vw, 228px" alt="Processing a picturethrough Primitive using 100 shapes" style=width:32%;float:left;margin-right:2%;padding-bottom:10px><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:228,f_auto,c_scale,w_500/v1509367395/pexels-photo-618463-square_pmbi9x.jpg sizes="(max-width: 768px) 33vw, 228px" alt="Original picture" style=width:32%;float:left;padding-bottom:10px></div><p><small class=caption>Processing <a href=/assets/images/posts/svg-placeholders/pexels-photo-618463-square.jpg>this picture</a> using Primitive, using <a href=/assets/images/posts/svg-placeholders/pexels-photo-618463-square-10.svg>10 shapes</a> and <a href=/assets/images/posts/svg-placeholders/pexels-photo-618463-square-100.svg>100 shapes</a>.</small></p><p>When using 10 shapes the images we start getting a grasp of the original image. In the context of image placeholders there is potential to use this SVG as the placeholder. Actually, the code for the SVG with 10 shapes is really small, around 1030 bytes, which goes down to ~640 bytes when passing the output through SVGO.</p><div class=code-wrap><figure class="highlight html"><table><tr><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>svg</span> <span class=attr>xmlns</span>=<span class=string>"http://www.w3.org/2000/svg"</span> <span class=attr>width</span>=<span class=string>"1024"</span> <span class=attr>height</span>=<span class=string>"1024"</span>&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#817c70"</span> <span class=attr>d</span>=<span class=string>"M0 0h1024v1024H0z"</span>/&gt;</span><span class=tag>&lt;<span class=name>g</span> <span class=attr>fill-opacity</span>=<span class=string>".502"</span>&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#03020f"</span> <span class=attr>d</span>=<span class=string>"M178 994l580 92L402-62"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#f2e2ba"</span> <span class=attr>d</span>=<span class=string>"M638 894L614 6l472 440"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#fff8be"</span> <span class=attr>d</span>=<span class=string>"M-62 854h300L138-62"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#76c2d9"</span> <span class=attr>d</span>=<span class=string>"M410-62L154 530-62 38"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#62b4cf"</span> <span class=attr>d</span>=<span class=string>"M1086-2L498-30l484 508"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#010412"</span> <span class=attr>d</span>=<span class=string>"M430-2l196 52-76 356"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#eb7d3f"</span> <span class=attr>d</span>=<span class=string>"M598 594l488-32-308 520"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#080a18"</span> <span class=attr>d</span>=<span class=string>"M198 418l32 304 116-448"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#3f201d"</span> <span class=attr>d</span>=<span class=string>"M1086 1062l-344-52 248-148"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#ebd29f"</span> <span class=attr>d</span>=<span class=string>"M630 658l-60-372 516 320"</span>/&gt;</span><span class=tag>&lt;/<span class=name>g</span>&gt;</span><span class=tag>&lt;/<span class=name>svg</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p>The images generated with 100 shapes are larger, as expected, weighting ~5kB after SVGO (8kB before). They have a great level of detail with a still small payload. The decision of how many triangles to use will depend largely on the type of image (eg contrast, amount of colours, complexity) and level of detail.</p><p>It would be possible to create a script similar to <a href=https://github.com/technopagan/cjpeg-dssim target=_blank rel=noopener>cpeg-dssim</a> that tweaks the amount of shapes used until a <a href=https://en.wikipedia.org/wiki/Structural_similarity target=_blank rel=noopener>structural similarity</a> threshold is met (or a maximum number of shapes in the worst case).</p><p>These resulting SVGs are great also to use as background images. Being size-constrained and vector-based they are a good candidate for hero images and large backgrounds that otherwise would show artifacts.</p><h4 id=SQIP><a href=#SQIP class=headerlink title=SQIP></a>SQIP</h4><p>In <a href=https://github.com/technopagan/sqip target=_blank rel=noopener>Tobias’ own words</a>:</p><blockquote><p>SQIP is an attempt to find a balance between these two extremes: it makes use of <a href=https://github.com/fogleman/primitive target=_blank rel=noopener>Primitive</a> to generate a SVG consisting of several simple shapes that approximate the main features visible inside the image, optimizes the SVG using <a href=https://github.com/svg/svgo target=_blank rel=noopener>SVGO</a> and adds a Gaussian Blur filter to it. This produces a SVG placeholder which weighs in at only ~800–1000 bytes, looks smooth on all screens and provides an visual cue of image contents to come.</p></blockquote><p>The result is similar to using a tiny placeholder image for the blur-up technique (what <a href=/medium-image-progressive-loading-placeholder>Medium</a> and <a href=/more-progressive-image-loading>other sites</a> do). The difference is that instead of using a bitmap image, eg JPG or WebP, the placeholder is SVG.</p><p>If we run SQIP against the original images we’ll get this:</p><div><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:342,f_auto,c_scale,w_670/v1509370309/pexels-photo-281184-square-sqip.svg_zspgb0.png sizes="(max-width: 768px) 50vw, 342px" alt="SQIP applied to an image" style=width:49%;float:left;margin-right:2%;padding-bottom:10px><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:342,f_auto,c_scale,w_670/v1509370308/pexels-photo-618463-square-sqip.svg_qjrexh.png sizes="(max-width: 768px) 50vw, 342px" alt="SQIP applied to an image" style=width:49%;float:left;padding-bottom:10px></div><p><small class=caption>The output images using SQIP for <a href=/assets/images/posts/svg-placeholders/pexels-photo-281184-square-sqip.svg>the first picture</a> and <a href=/assets/images/posts/svg-placeholders/pexels-photo-618463-square-sqip.svg>the second one</a>.</small></p><p>The output SVG is ~900 bytes, and inspecting the code we can spot the <code>feGaussianBlur</code> filter applied to the group of shapes:</p><div class=code-wrap><figure class="highlight html"><table><tr><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>svg</span> <span class=attr>xmlns</span>=<span class=string>"http://www.w3.org/2000/svg"</span> <span class=attr>viewBox</span>=<span class=string>"0 0 2000 2000"</span>&gt;</span><span class=tag>&lt;<span class=name>filter</span> <span class=attr>id</span>=<span class=string>"b"</span>&gt;</span><span class=tag>&lt;<span class=name>feGaussianBlur</span> <span class=attr>stdDeviation</span>=<span class=string>"12"</span> /&gt;</span><span class=tag>&lt;/<span class=name>filter</span>&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#817c70"</span> <span class=attr>d</span>=<span class=string>"M0 0h2000v2000H0z"</span>/&gt;</span><span class=tag>&lt;<span class=name>g</span> <span class=attr>filter</span>=<span class=string>"url(#b)"</span> <span class=attr>transform</span>=<span class=string>"translate(4 4) scale(7.8125)"</span> <span class=attr>fill-opacity</span>=<span class=string>".5"</span>&gt;</span><span class=tag>&lt;<span class=name>ellipse</span> <span class=attr>fill</span>=<span class=string>"#000210"</span> <span class=attr>rx</span>=<span class=string>"1"</span> <span class=attr>ry</span>=<span class=string>"1"</span> <span class=attr>transform</span>=<span class=string>"matrix(50.41098 -3.7951 11.14787 148.07886 107 194.6)"</span>/&gt;</span><span class=tag>&lt;<span class=name>ellipse</span> <span class=attr>fill</span>=<span class=string>"#eee3bb"</span> <span class=attr>rx</span>=<span class=string>"1"</span> <span class=attr>ry</span>=<span class=string>"1"</span> <span class=attr>transform</span>=<span class=string>"matrix(-56.38179 17.684 -24.48514 -78.06584 205 110.1)"</span>/&gt;</span><span class=tag>&lt;<span class=name>ellipse</span> <span class=attr>fill</span>=<span class=string>"#fff4bd"</span> <span class=attr>rx</span>=<span class=string>"1"</span> <span class=attr>ry</span>=<span class=string>"1"</span> <span class=attr>transform</span>=<span class=string>"matrix(35.40604 -5.49219 14.85017 95.73337 16.4 123.6)"</span>/&gt;</span><span class=tag>&lt;<span class=name>ellipse</span> <span class=attr>fill</span>=<span class=string>"#79c7db"</span> <span class=attr>cx</span>=<span class=string>"21"</span> <span class=attr>cy</span>=<span class=string>"39"</span> <span class=attr>rx</span>=<span class=string>"65"</span> <span class=attr>ry</span>=<span class=string>"65"</span>/&gt;</span><span class=tag>&lt;<span class=name>ellipse</span> <span class=attr>fill</span>=<span class=string>"#0c1320"</span> <span class=attr>cx</span>=<span class=string>"117"</span> <span class=attr>cy</span>=<span class=string>"38"</span> <span class=attr>rx</span>=<span class=string>"34"</span> <span class=attr>ry</span>=<span class=string>"47"</span>/&gt;</span><span class=tag>&lt;<span class=name>ellipse</span> <span class=attr>fill</span>=<span class=string>"#5cb0cd"</span> <span class=attr>rx</span>=<span class=string>"1"</span> <span class=attr>ry</span>=<span class=string>"1"</span> <span class=attr>transform</span>=<span class=string>"matrix(-39.46201 77.24476 -54.56092 -27.87353 219.2 7.9)"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#e57339"</span> <span class=attr>d</span>=<span class=string>"M271 159l-123-16 43 128z"</span>/&gt;</span><span class=tag>&lt;<span class=name>ellipse</span> <span class=attr>fill</span>=<span class=string>"#47332f"</span> <span class=attr>cx</span>=<span class=string>"214"</span> <span class=attr>cy</span>=<span class=string>"237"</span> <span class=attr>rx</span>=<span class=string>"242"</span> <span class=attr>ry</span>=<span class=string>"19"</span>/&gt;</span><span class=tag>&lt;/<span class=name>g</span>&gt;</span><span class=tag>&lt;/<span class=name>svg</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p>SQIP can also output an image tag with the SVG contents Base 64 encoded:</p><div class=code-wrap><figure class="highlight html"><table><tr><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>img</span> <span class=attr>width</span>=<span class=string>"640"</span> <span class=attr>height</span>=<span class=string>"640"</span> <span class=attr>src</span>=<span class=string>"example.jpg"</span> <span class=attr>alt</span>=<span class=string>"Add descriptive alt text"</span> <span class=attr>style</span>=<span class=string>"background-size: cover; background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAw...&lt;stripped base 64&gt;...PjwvZz48L3N2Zz4=);"</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h4 id=Silhouettes><a href=#Silhouettes class=headerlink title=Silhouettes></a>Silhouettes</h4><p>We just had a look at using SVGs for edges and primitive shapes. Another possibility is to vectorise the images “tracing” them. <a href=https://twitter.com/mikaelainalem target=_blank rel=noopener>Mikael Ainalem</a> shared <a href="https://codepen.io/ainalem/full/aLKxjm/" target=_blank rel=noopener>a codepen</a> a few days ago showing how to use a 2-colour silhouette as a placeholder. The result is really pretty:</p><video controls style=max-width:100% width=690 height=459><source src=https://res.cloudinary.com/jmperez/video/upload/dpr_auto,f_auto,q_auto,c_scale/v1509278615/silhouette-lazy-loading_evq9xq.mp4 type=video/mp4></source></video><p>The SVGs in this case were hand drawn, but the technique quickly spawned integrations with tools to automate the process.</p><ul><li><a href=https://www.gatsbyjs.org target=_blank rel=noopener>Gatsby</a>, a static site generator using React supports these traced SVGs now. It uses <a href=https://www.npmjs.com/package/potrace target=_blank rel=noopener>a JS port of potrace</a> to vectorise the images.</li></ul><blockquote class=twitter-tweet data-lang=en-gb><p lang=en dir=ltr>Excited to announce that Gatsby now has super simple support for traced SVG!<br><br>Thanks to <a href="https://twitter.com/fk?ref_src=twsrc%5Etfw" target=_blank rel=noopener>@fk</a> for his great work!<a href=https://t.co/XfgEDbSILA target=_blank rel=noopener>https://t.co/XfgEDbSILA</a> <a href=https://t.co/wTwOgT8C5V target=_blank rel=noopener>pic.twitter.com/wTwOgT8C5V</a></p>&mdash; Gatsby (@gatsbyjs) <a href="https://twitter.com/gatsbyjs/status/923304195666485248?ref_src=twsrc%5Etfw" target=_blank rel=noopener>25 October 2017</a></blockquote><ul><li><a href=https://craftcms.com target=_blank rel=noopener>Craft 3 CMS</a>, which also added support for silhouettes. It uses <a href=https://github.com/nystudio107/craft3-imageoptimize/blob/master/src/lib/Potracio.php target=_blank rel=noopener>a PHP port of potrace</a>.</li></ul><blockquote class=twitter-tweet data-lang=en-gb><p lang=en dir=ltr>Cool video of using inline SVG images as lazy loading placeholders w/ ImageOptimize &amp; Craft 3 from <a href="https://twitter.com/slebbo?ref_src=twsrc%5Etfw" target=_blank rel=noopener>@slebbo</a> <a href=https://t.co/E1dYA4ayow target=_blank rel=noopener>https://t.co/E1dYA4ayow</a> <a href="https://twitter.com/hashtag/craftcms?src=hash&amp;ref_src=twsrc%5Etfw" target=_blank rel=noopener>#craftcms</a> <a href=https://t.co/ruf8i6URCT target=_blank rel=noopener>pic.twitter.com/ruf8i6URCT</a></p>&mdash; nystudio107 (@nystudio107) <a href="https://twitter.com/nystudio107/status/920673966091534338?ref_src=twsrc%5Etfw" target=_blank rel=noopener>18 October 2017</a></blockquote><ul><li><a href=https://github.com/EmilTholin/image-trace-loader target=_blank rel=noopener>image-trace-loader</a>, a Webpack loader that uses potrace to process the images.</li></ul><blockquote class=twitter-tweet data-lang=en-gb><p lang=en dir=ltr>I just released image-trace-loader, a <a href="https://twitter.com/hashtag/webpack?src=hash&amp;ref_src=twsrc%5Etfw" target=_blank rel=noopener>#webpack</a> loader that exports traced outlines as image/svg+xml data.<a href=https://t.co/2VZaKVaE4p target=_blank rel=noopener>https://t.co/2VZaKVaE4p</a> <a href=https://t.co/vRma67R7zb target=_blank rel=noopener>pic.twitter.com/vRma67R7zb</a></p>&mdash; Emil Tholin (@Tholle1234) <a href="https://twitter.com/Tholle1234/status/920423596346019840?ref_src=twsrc%5Etfw" target=_blank rel=noopener>17 October 2017</a></blockquote><p>It’s also interesting to see a comparison of the output between Emil’s webpack loader (based on potrace) and Mikael’s hand-drawn SVGs.</p><blockquote class=twitter-tweet data-lang=en-gb><p lang=en dir=ltr>Comparison of <a href="https://twitter.com/mikaelainalem?ref_src=twsrc%5Etfw" target=_blank rel=noopener>@mikaelainalem</a> &#39;s SVG lazy-loading technique <a href=https://t.co/mbqVpxzn72 target=_blank rel=noopener>https://t.co/mbqVpxzn72</a> with @Tholle123&#39;s webpack loader <a href=https://t.co/3jxjtNP8dm target=_blank rel=noopener>https://t.co/3jxjtNP8dm</a> <a href=https://t.co/tChcPK0mIK target=_blank rel=noopener>pic.twitter.com/tChcPK0mIK</a></p>&mdash; Yuriy Nemtsov (@nemtsovy) <a href="https://twitter.com/nemtsovy/status/920647706799955970?ref_src=twsrc%5Etfw" target=_blank rel=noopener>18 October 2017</a></blockquote><p>I assume the output generated by potrace is using the default options. However, it’s possible to tweak them. Check <a href=https://github.com/EmilTholin/image-trace-loader#options target=_blank rel=noopener>the options for image-trace-loader</a>, which are pretty much <a href=https://www.npmjs.com/package/potrace#parameters target=_blank rel=noopener>the ones passed down to potrace</a>.</p><h2 id=Summary><a href=#Summary class=headerlink title=Summary></a>Summary</h2><p>We have seen different tools and techniques to generate SVGs from images and use them as placeholders. The same way <a href="/webp-placeholder-images/">WebP is a fantastic format for thumbnails</a>, SVG is also an interesting format to use in placeholders. We can control the level of detail (and thus, size), it’s highly compressible and easy to manipulate with CSS and JS.</p><h2 id=Extra-Resources><a href=#Extra-Resources class=headerlink title="Extra Resources"></a>Extra Resources</h2><p>This post made it to <a href="https://news.ycombinator.com/item?id=15696596" target=_blank rel=noopener>the top of Hacker News and got a lot of points and comments</a>. I’m very grateful for that, and for all the links to other resources that have been shared in the comments on that page. Here are a few of them!</p><ul><li><a href=https://github.com/Tw1ddle/geometrize-haxe target=_blank rel=noopener>Geometrize</a> is a port of Primitive written in Haxe. There is also <a href=https://github.com/Tw1ddle/geometrize-haxe-web target=_blank rel=noopener>a JS implementation</a> that you can try out directly <a href="http://www.samcodes.co.uk/project/geometrize-haxe-web/" target=_blank rel=noopener>on your browser</a>.</li><li><a href=https://github.com/ondras/primitive.js target=_blank rel=noopener>Primitive.js</a>, which is a port of Primitive in JS. Also, <a href=https://github.com/cielito-lindo-productions/primitive.nextgen target=_blank rel=noopener>primitive.nextgen</a>, which is a port of the Primitive desktop app using Primitive.js and Electron.</li><li>There are a couple of Twitter accounts where you can see examples of images generated with Primitive and Geometrize. Check out <a href=https://twitter.com/PrimitivePic target=_blank rel=noopener>@PrimitivePic</a> and <a href=https://twitter.com/Geometrizer target=_blank rel=noopener>@Geometrizer</a>.</li><li><a href=https://github.com/jankovicsandras/imagetracerjs target=_blank rel=noopener>imagetracerjs</a>, which is a raster image tracer and vectorizer written in JavaScript. There are also ports for <a href=https://github.com/jankovicsandras/imagetracerjava target=_blank rel=noopener>Java</a> and <a href=https://github.com/jankovicsandras/imagetracerandroid target=_blank rel=noopener>Android</a>.</li></ul><h2 id=Related-Posts><a href=#Related-Posts class=headerlink title="Related Posts"></a>Related Posts</h2><p>If you have enjoyed this post, check out these other posts I have written about techniques loading images:</p><ul><li><a href=/medium-image-progressive-loading-placeholder>How Medium does progressive image loading</a></li><li><a href=/webp-placeholder-images>Using WebP to create tiny preview images</a></li><li><a href=/more-progressive-image-loading>More examples of Progressive Image Loading</a></li></ul><p><em>This post is also available <a href=/es/svg-placeholders>in Spanish</a></em></p><script async src=https://platform.twitter.com/widgets.js charset=utf-8></script></div><hr/></article></div><script>"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js").then(function(n){})["catch"](function(n){})});</script><footer><section class=links><a href=https://twitter.com/jmperezperez>@jmperezperez</a> on Twitter · <a href=https://github.com/JMPerez>GitHub</a> · <a href=http://www.linkedin.com/in/jmperezperez>LinkedIn</a></section><div class=timing-stats></div></footer><script>window.addEventListener('load', () => {
     setTimeout(() => {
      var t = window.performance && performance.timing;
      function round2(num) { return Math.round(num * 100) / 100; }
      if (t) {
          var timingStats = document.querySelector('.timing-stats');
          var loadTime = (t.loadEventEnd - t.navigationStart) / 1000;
          var timingStatsHTML = 'This page loaded in ' + round2(loadTime) + ' seconds. ';
          var performanceEntries = performance.getEntriesByType('paint');
          performanceEntries.forEach(function(performanceEntry, i, entries) {
            var name = performanceEntry.name;
            if (name === 'first-paint') {
              name = '<abbr title=' + name + '>FP</abbr>';
            } else if (name === 'first-contentful-paint') {
              name = '<abbr title=' + name + '>FCP</abbr>';
            }
            timingStatsHTML += name + ' was ' + round2(performanceEntry.startTime / 1000) + ' seconds. ';
          });
          timingStats.innerHTML = timingStatsHTML;
      }
    }, 0);
   });</script></body></html>