<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta http-equiv=Accept-CH content="DPR, Viewport-Width, Width"><title>Usando SVG como placeholders — Más técnicas de carga de imágenes - José M. Pérez</title><meta name=description content="Optimización del rendimiento web utilizando carga diferida de imágenes con SVGs como placeholders, representando contornos, formas y siluetas."><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover"><link rel=author href="https://plus.google.com/107456024651797783420"/><link rel=alternate type=application/rss+xml title="Jose M. Perez" href=https://jmperezperez.com/feed.xml><meta name=twitter:card content=summary_large_image><meta name=twitter:url content="https://jmperezperez.com/es/svg-placeholders/" property=og:url><meta name=twitter:title content="Usando SVG como placeholders — Más técnicas de carga de imágenes - José M. Pérez" property=og:title><meta name=twitter:description content="Optimización del rendimiento web utilizando carga diferida de imágenes con SVGs como placeholders, representando contornos, formas y siluetas." property=og:description><meta name=twitter:site content=@jmperezperez><meta property=og:image content=https://jmperezperez.com/assets/images/posts/svg-placeholders/jmperez-composition-primitive.jpg><meta name=twitter:image content=https://jmperezperez.com/assets/images/posts/svg-placeholders/jmperez-composition-primitive.jpg><meta property=fb:app_id content=1702266270006013><meta property=fb:pages content="1639848659664211"/><link rel=canonical href="https://jmperezperez.com/es/svg-placeholders/"/><style>a,a:hover{color:#2a7cb2}.post::after,hr{display:block;clear:both}#page,.main-header,.videoWrapper{position:relative}.code,code,pre{letter-spacing:0}.code-wrap pre,pre{white-space:pre-wrap}.caption,.main-header,.me,.pagination,.pagination a,footer{text-align:center}*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;border:none;font:inherit;margin:0;padding:0;vertical-align:baseline}button,input{background:0 0}body{background:#fff;color:#555;font-family:Georgia,Times;font-weight:300;font-style:normal;font-size:19px;line-height:1.725;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-text-size-adjust:100%}blockquote,em{font-style:italic}@media(max-width:800px){body{font-size:17px}}@media(max-width:600px){body{font-size:15px}}h1,h2,h3,h4,h5{color:#212121;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:600;font-size:1em;line-height:1.3;margin-bottom:1em}h2,h3,h4,h5{margin-top:2em}#menu a,.button{font-weight:400}.post ol,.post ul,amp-video,amp-vimeo,amp-youtube,iframe,p,video{margin:0 0 1em}.quote,blockquote,ol,ul{margin:0 0 15px}twitterwidget{margin-bottom:1em!important}a{font-weight:inherit;text-decoration:none;transition:color .15s ease-out,border-bottom-color .15s ease-out}p a{border-bottom:1px solid #eee}p a:hover{border-bottom-color:#212121}strong{font-weight:700}h2,h3{font-weight:400}h1{font-size:1.7em}h2{color:#444;font-size:1.6em}h3{color:#666;font-size:1.4em}h4{font-size:1.18em}h5{font-size:1em}a h1,a h2,a h3,a h4,a h5{transition:color .15s ease-out}a:hover h1,a:hover h2,a:hover h3,a:hover h4,a:hover h5{color:#3498db}blockquote{border-left:2px solid #ccc;padding-left:20px}ol,ul{padding-left:25px}ul{list-style:square}ol{list-style:decimal}hr{background:#eee;color:#eee;height:2px;margin:30px auto;width:50%}.main-header,.post,.post .svg-container object{width:100%}code,pre{color:#333;font-family:Courier,Menlo,Monaco;font-size:.8em;overflow-x:auto}.author,.main-header{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}pre{padding:.8em 1em}code{margin:0}.post::after{content:''}.main-header{background-color:#005689;overflow:hidden;padding:1em}#menu{display:inline-block;margin:1px 0}#menu a{color:#fff;font-size:14px;margin-left:15px;padding:20px 10px;text-transform:uppercase}@media(max-width:500px){#menu a{margin-left:10px;padding:10px 5px}}#menu a:first-child{margin-left:0}#menu a[aria-current]{font-weight:700}#page{margin:0 auto;max-width:40em;padding:3em 2em}.videoWrapper{height:0;margin-bottom:1em;padding-bottom:56.25%;padding-top:25px}.videoWrapper amp-youtube,.videoWrapper iframe{height:100%;left:0;position:absolute;top:0;width:100%}.wrapper{border-top:2px solid #eee;padding:3em 0}.wrapper:first-child{border-top:none;padding-top:5%}.posts-list h2{margin-top:0}.post{display:block}.post div[itemprop=articleBody]>p:first-child{color:#333}.post li{margin-bottom:.5em}.post p img{border:1px solid #eee;display:block;max-width:100%}.post img+.caption{padding-top:5px}.post .svg-container{margin-bottom:5%;max-width:100%;text-align:center}video{height:auto;max-width:100%}.pagination a{min-width:30px;max-height:30px}footer{border-top:1px dashed #ddd;padding:2em}.timing-stats{font-size:.7em;padding:.35em}.button{background-color:#fff;border:1px solid #555;border-radius:20px;color:#555;display:inline-block;font-size:13px;line-height:10px;padding:10px 20px;transition:background-color .15s ease-out}.button:hover{background-color:#3498db;border-color:transparent;color:#fff}.button.inactive{background-color:#ccc;color:#fff}.search-goog input{border:2px solid #ddd;padding:10px}.search-goog input[type=submit]{background-color:#ddd;cursor:pointer}@media only screen and (max-width:768px){#page,.wrapper{margin:0;max-width:100%;padding:1.5em;width:100%}.wrapper{padding:10% 0}.wraper::after{clear:both;content:'';display:block}.post{margin:0 auto;max-width:640px}}.outscreen{height:1px;left:-1000px;overflow:hidden;position:absolute;top:auto;width:1px}.callout{border:1px solid #eee;border-left-color:#777;border-left-width:5px;border-radius:3px;font-size:90%;padding:20px;margin:20px 0}.author{font-size:.8em;margin-bottom:2em}.author .name{line-height:1.5;padding-top:.35em}.bd,.media{overflow:hidden;zoom:1}.media .img{float:left}.avatar-img{border-radius:100%;height:3.5em;margin-right:.5em;width:3.5em}.highlight{border:1px solid #eee;margin-bottom:1em;overflow-x:auto}.code{background:#fff;color:#333;display:block;overflow-x:auto}.code .comment,.code .meta{color:#969896}.code .emphasis,.code .quote,.code .string,.code .strong,.code .template-variable,.code .variable{color:#df5000}.code .keyword,.code .selector-tag,.code .type{color:#a71d5d}.code .attribute,.code .bullet,.code .literal,.code .symbol{color:#0086b3}.code .name,.code .section{color:#63a35c}.code .tag{color:#333}.code .attr,.code .selector-attr,.code .selector-class,.code .selector-id,.code .selector-pseudo,.code .title{color:#795da3}.code .addition{background-color:#eaffea;color:#55a532}.code .deletion{background-color:#ffecec;color:#bd2c00}.code .link{text-decoration:underline}.caption{display:block;font-size:.8em}.codepen-aspect-ratio>iframe{height:100%;position:absolute;width:100%}.twitter-tweet{margin-left:auto;margin-right:auto}.twitter-tweet::after{content:"";display:block;padding-bottom:20px;width:100%}.me{max-width:20em;margin:0 auto .5em}.me h1{margin-bottom:0}</style><link rel=amphtml href="/es/svg-placeholders/amp/"><meta name=theme-color content=#005689><link rel=manifest href=/manifest.json><link rel=alternate hreflang=en href="/svg-placeholders/"/><link rel=alternate hreflang=es href="/es/svg-placeholders/"/></head><body><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-39254352-1","auto"),ga("send","pageview");</script><header class=main-header><nav id=menu><a href="/">Blog</a> <a href="/projects/">Projects</a> <a href="/talks/">Speaking</a> <a href="/about-me/">About</a></nav></header><div id=page><article class=wrapper><div class=post><header><script type=application/ld+json>{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Usando SVG como placeholders — Más técnicas de carga de imágenes",
  
  "description": "Optimización del rendimiento web utilizando carga diferida de imágenes con SVGs como placeholders, representando contornos, formas y siluetas.",
  
  "mainEntityOfPage":{
      "@type":"WebPage",
      "@id":"https://jmperezperez.com/es/svg-placeholders/"
  },
  "datePublished": "2017-10-29T21:30:00.000Z",
  "dateModified": "2018-03-19T15:24:57.718Z",
  
  "image": {
    "@type": "ImageObject",
    "url": "https://jmperezperez.com/assets/images/posts/svg-placeholders/jmperez-composition-primitive.jpg",
    "width" : "2040",
    "height" : "1024"
  },
  
  "author": {
      "@type": "Person",
      "name": "Jose M. Perez",
      "url": "https://jmperezperez.com",
      "sameAs": [
        "http://www.linkedin.com/in/jmperezperez",
        "https://twitter.com/jmperezperez"
      ]
  },
  "publisher": {
      "@type": "Organization",
      "name": "Jose M. Perez's Blog"
      
      ,
      "logo": {
        "@type": "ImageObject",
        "url": "https://jmperezperez.com/assets/images/logo.png",
        "width": 600,
        "height": 60
      }
      
  }
}</script><div class="media author"><div class=img><a href="/about-me/"><img src=https://res.cloudinary.com/jmperez/image/upload/w_120,f_auto,c_scale/v1519156883/profile_ysrm5y.jpg class=avatar-img alt="" height=53 width=53 sizes=53px></a></div><div class=bd><address class=name itemprop=author itemscope itemtype=https://schema.org/Person><a href="/about-me/" itemprop=name>José M. Pérez</a></address><meta class=post-data itemprop=datePublished content=2017-10-29T21:30:00.000Z>octubre 29 2017</div></div><h1>Usando SVG como placeholders — Más técnicas de carga de imágenes</h1></header><p>Me apasiona la optimización del rendimiento de imágenes y hacer que las imágenes carguen rápido. Una de las áreas de estudio más interesantes es el placeholder: qué mostrar cuando la imagen todavía no se ha cargado.</p><p>Durante los últimos días me he encontrado con algunas técnicas de carga que usan SVG, y me gustaría describirlas en este post.</p><p><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:684,f_auto,c_scale/v1509278557/jmperez-composition-primitive_j8zyfn.jpg sizes="(max-width: 768px) 100vw, 684px" alt="Ejemplo de un SVG generado utilizando 10 y 100 triángulos basado en una imagen de mapa de bits"> <small class=caption>Los SVGs generados a partir de imágenes pueden ser usados como placeholders. ¡Sigue leyendo!</small></p><a id=more></a><p>En esta publicación hablaré sobre estos temas:</p><ul><li>Descripción general de los diferentes tipos de placeholders</li><li>Placeholders basados en SVG (contornos, formas y siluetas)</li><li>Automatización del proceso.</li></ul><h3 id=Descripcion-general-de-los-diferentes-tipos-de-placeholders><a href=#Descripcion-general-de-los-diferentes-tipos-de-placeholders class=headerlink title="Descripción general de los diferentes tipos de placeholders"></a>Descripción general de los diferentes tipos de placeholders</h3><p>En el pasado <a href=/lazy-loading-images>he escrito sobre placeholders y lazy-load de imágenes</a>, y también <a href="https://www.youtube.com/watch?v=szmVNOnkwoU" target=_blank rel=noopener>he dado charlas sobre ello</a>. Cuando se hace lazy-load de imágenes es conveniente pensar en qué renderizar como placeholder, dado que puede tener un gran impacto en el rendimiento percibido por el usuario. Hace un tiempo describí algunas opciones:</p><p><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:684,f_auto,c_scale/v1509278557/placeholder-options_vtwp6b.png sizes="(max-width: 768px) 100vw, 684px"> <small class=caption>Diferentes estrategias para rellenar el área de una imagen mientras ésta carga.</small></p><ul><li><strong>Mantener el espacio vacío para las imágenes</strong>: En un mundo de diseño responsive, reservar el área para la imagen evita que el contenido salte. Los cambios de layout son malos desde el punto de vista de la experiencia de usuario, pero también son nefastos en cuanto al rendimiento. El navegador debe recalcular el layout cada vez que obtiene las dimensiones de una imagen, para dejar espacio para la misma.</li><li><strong>Placeholder</strong>: Imagina que estamos mostrando la imagen de perfil de un usuario. Quizás queremos mostrar una silueta como imagen de background. Esta imagen se muestra mientras la imagen principal está cargando, pero también si la petición falla o si el usuario no ha establecido ninguna imagen de perfil. Habitualmente estas imágenes son vectoriales, y dado su pequeño tamaño son excelentes candidatas para ser servidas inline.</li><li><strong>Color sólido</strong>: Podemos tomar un color de la imagen y usarlo como color de fondo en el placeholder. Puede ser el color dominante, el más vibrante… La idea es que está basado o extraído de la imagen que se desea cargar, y el resultado debería ayudar a suavizar la transición entre “no imagen” e “imagen cargada”.</li><li><strong>Imagen desenfocada</strong>: También llamada técnica <em>blur up</em>. Se renderiza una versión muy pequeña de la imagen y se hace la transición a la imagen completa. La imagen inicial es pequeña tanto en píxeles como en kBs. Para eliminar artefactos de compresión la imagen se amplía y se desenfoca. He escrito previamente sobre este tema en <a href=/medium-image-progressive-loading-placeholder>Cómo Medium hacer carga progresiva de imágenes</a>, <a href=/webp-placeholder-images>Usando WebP para crear previsualizaciones pequeñas</a>, y <a href=/more-progressive-image-loading>Más ejemplos de carga progresiva de imágenes</a>.</li></ul><p>Resulta que hay muchas otras variaciones y mucha gente inteligente desarrollando otras técnicas para crear placeholders.</p><p>Una de ellas es generar gradientes o degradados en vez de colores sólidos. Los gradientes pueden crear una previsualización de la imagen final más precisa, con unos pocos bytes extra.</p><p><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:684,f_auto,c_scale,w_1368/v1509278575/gradient-background_jyymty.jpg sizes="(max-width: 768px) 100vw, 684px" alt="Usando gradientes como fondos. Captura tomada de Gradify"> <small class=caption>Usando gradientes como fondos. Captura de Gradify, que ya no está disponible on-line. El código <a href=https://github.com/fraser-hemp/gradify target=_blank rel=noopener>está en GitHub</a>.</small></p><p>Otra técnica consiste en utilizar SVGs basados en la imagen, que está popularizándose gracias a algunos hacks y experimentos recientes.</p><h3 id=Placeholders-basados-en-SVG><a href=#Placeholders-basados-en-SVG class=headerlink title="Placeholders basados en SVG"></a>Placeholders basados en SVG</h3><p>Sabemos que los SVGs son ideales para imágenes vectoriales. En la mayoría de casos queremos cargar una imagen de mapa de bits (JPG, PNG…), así que la cuestión es cómo vectorizar la imagen. Podemos utilizar contornos, formas y áreas.</p><h4 id=Contornos><a href=#Contornos class=headerlink title=Contornos></a>Contornos</h4><p>En <a href=/drawing-edges-svg>un post anterior</a> expliqué cómo calcular los contornos de una imagen y animarlos. Mi objetivo inicial era intentar dibujar regiones, vectorizando la imagen, pero no sabía cómo hacerlo. Me di cuenta de que usando los contornos también podía ser innovador y decidí animarlos para crear un efecto de “dibujado”.</p><div class=codepen-aspect-ratio style="margin-bottom: 10px; padding-bottom: 100%; position: relative; width: 100%"><iframe id=cp_embed_oogqdp src="//codepen.io/jmperez/embed/oogqdp?height=600&theme-id=0&slug-hash=oogqdp&default-tab=result" scrolling=no frameborder=no height=600 allowtransparency=true allowfullscreen=true class=cp_embed_iframe data-amp-width=600 style="width: 600; overflow: hidden"></iframe></div><h4 id=Formas><a href=#Formas class=headerlink title=Formas></a>Formas</h4><p>También podemos usar SVG para dibujar áreas de la imagen en lugar de contornos o bordes. De alguna manera estaríamos vectorizando una imagen de mapa de bits para crear un placeholder.</p><p>En su día intenté hacer algo similar con triángulos. Puedes ver el resultado en mis charlas <a href=/cssconfau16/#/45>en CSSConf</a> y <a href=/renderconf17/#/46>Render Conf</a>.</p><div class=codepen-aspect-ratio style="margin-bottom: 10px; padding-bottom: 74%; position: relative; width: 100%"><iframe id=cp_embed_BmaWmQ src="//codepen.io/jmperez/embed/BmaWmQ?height=444&theme-id=0&slug-hash=BmaWmQ&default-tab=result" scrolling=no frameborder=no height=444 allowtransparency=true allowfullscreen=true class=cp_embed_iframe data-amp-width=600 style="width: 600; overflow: hidden"></iframe></div><p>Este codepen es una prueba de concepto de un placeholder basado en SVG compuesto por 245 triángulos. La generación de los triángulos utiliza la <a href=https://es.wikipedia.org/wiki/Triangulaci%C3%B3n_de_Delaunay target=_blank rel=noopener>triangulación de Delaunay</a> a partir del proyecto <a href=https://github.com/possan/polyserver target=_blank rel=noopener>polyserver de Possan</a>. Como es de esperar, a mayor número de triángulos, mayor es el tamaño del fichero resultante.</p><h4 id=Primitive-y-SQIP-una-tecnica-LQIP-basada-en-SVG><a href=#Primitive-y-SQIP-una-tecnica-LQIP-basada-en-SVG class=headerlink title="Primitive y SQIP, una técnica LQIP basada en SVG"></a>Primitive y SQIP, una técnica LQIP basada en SVG</h4><p>Tobias Baldauf ha estado trabajando en otra técnica LQIP (<em>Low-Quality Image Placeholder</em>) usando SVGs llamada <a href=https://github.com/technopagan/sqip target=_blank rel=noopener>SQIP</a>. Antes de adentrarnos en SQIP, me gustaría describir <a href=https://github.com/fogleman/primitive target=_blank rel=noopener>Primitive</a>, una librería que SQIP utiliza internamente.</p><p>Primitive es fascinante y recomiendo definitivamente que le eches un ojo. Convierte una imagen de mapa de bits en un SVG compuesto por formas que se solapan. Su pequeño tamaño lo hace ideal para incluirlo de forma inline en la página. Así se consigue reducir una petición, a la vez que se renderiza un placeholder bastante cercano a la imagen final incrustada en el cuerpo del HTML inicial.</p><p>Primitive genera una imagen basada en figuras como triángulos, rectángulos y círculos entre otros. En cada paso añade una figura. A más pasos, la imagen resultante se va pareciendo más a la imagen original. Si el formato de salida elegido es SVG, también significa que el fichero será más grande cuantas más figuras contenga.</p><p>Para comprender cómo funciona Primitive lo ejecuté tomando un par de imágenes de prueba. Generé SVGs a partir de las imágenes usando 10 y 100 triángulos:</p><div><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:228,f_auto,c_scale,w_500/v1509367394/pexels-photo-281184-square-10.svg_ifiu2z.png sizes="(max-width: 768px) 33vw, 228px" alt="Procesando una imagen usando Primitive con 10 triángulos" style=width:32%;float:left;margin-right:2%;padding-bottom:10px><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:228,f_auto,c_scale,w_500/v1509367394/pexels-photo-281184-square-100.svg_tkr8el.png sizes="(max-width: 768px) 33vw, 228px" alt="Procesando una imagen usando Primitive con 100 triángulos" style=width:32%;float:left;margin-right:2%;padding-bottom:10px><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:228,f_auto,c_scale,w_500/v1509367395/pexels-photo-281184-square_tuhvso.jpg sizes="(max-width: 768px) 33vw, 228px" alt="Imagen original" style=width:32%;float:left;padding-bottom:10px></div><p><small class=caption>Procesando <a href=/assets/images/posts/svg-placeholders/pexels-photo-281184-square.jpg>esta imagen</a> con Primitive, usando <a href=/assets/images/posts/svg-placeholders/pexels-photo-281184-square-10.svg>10 triángulos</a> y <a href=/assets/images/posts/svg-placeholders/pexels-photo-281184-square-100.svg>100 triángulos</a>.</small></p><div><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:228,f_auto,c_scale,w_500/v1509367394/pexels-photo-618463-square-10.svg_aeonon.png sizes="(max-width: 768px) 33vw, 228px" alt="Procesando una imagen usando Primitive con 10 triángulos" style=width:32%;float:left;margin-right:2%;padding-bottom:10px><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:228,f_auto,c_scale,w_500/v1509367394/pexels-photo-618463-square-100.svg_t6pwcv.png sizes="(max-width: 768px) 33vw, 228px" alt="Procesando una imagen usando Primitive con 100 triángulos" style=width:32%;float:left;margin-right:2%;padding-bottom:10px><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:228,f_auto,c_scale,w_500/v1509367395/pexels-photo-618463-square_pmbi9x.jpg sizes="(max-width: 768px) 33vw, 228px" alt="Imagen original" style=width:32%;float:left;padding-bottom:10px></div><p><small class=caption>Procesando <a href=/assets/images/posts/svg-placeholders/pexels-photo-618463-square.jpg>esta imagen</a> con Primitive, usando <a href=/assets/images/posts/svg-placeholders/pexels-photo-618463-square-10.svg>10 triángulos</a> y <a href=/assets/images/posts/svg-placeholders/pexels-photo-618463-square-100.svg>100 triángulos</a>.</small></p><p>Usando 10 triángulos las imágenes empiezan a parecerse a la versión original. Estas imágenes SVG pueden ser adecuadas como placeholders. De hecho el código del SVG de 10 triángulos es muy pequeño, unos 1.030 bytes, que pueden reducirse hasta unos 640 bytes si pasamos la salida por SVGO.</p><div class=code-wrap><figure class="highlight html"><table><tr><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>svg</span> <span class=attr>xmlns</span>=<span class=string>"http://www.w3.org/2000/svg"</span> <span class=attr>width</span>=<span class=string>"1024"</span> <span class=attr>height</span>=<span class=string>"1024"</span>&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#817c70"</span> <span class=attr>d</span>=<span class=string>"M0 0h1024v1024H0z"</span>/&gt;</span><span class=tag>&lt;<span class=name>g</span> <span class=attr>fill-opacity</span>=<span class=string>".502"</span>&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#03020f"</span> <span class=attr>d</span>=<span class=string>"M178 994l580 92L402-62"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#f2e2ba"</span> <span class=attr>d</span>=<span class=string>"M638 894L614 6l472 440"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#fff8be"</span> <span class=attr>d</span>=<span class=string>"M-62 854h300L138-62"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#76c2d9"</span> <span class=attr>d</span>=<span class=string>"M410-62L154 530-62 38"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#62b4cf"</span> <span class=attr>d</span>=<span class=string>"M1086-2L498-30l484 508"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#010412"</span> <span class=attr>d</span>=<span class=string>"M430-2l196 52-76 356"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#eb7d3f"</span> <span class=attr>d</span>=<span class=string>"M598 594l488-32-308 520"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#080a18"</span> <span class=attr>d</span>=<span class=string>"M198 418l32 304 116-448"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#3f201d"</span> <span class=attr>d</span>=<span class=string>"M1086 1062l-344-52 248-148"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#ebd29f"</span> <span class=attr>d</span>=<span class=string>"M630 658l-60-372 516 320"</span>/&gt;</span><span class=tag>&lt;/<span class=name>g</span>&gt;</span><span class=tag>&lt;/<span class=name>svg</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p>Las imágenes generadas con 100 triángulos son más grandes, en kB, como es de esperar. En esta prueba las imágenes ocupan unos 5kB tras aplicar SVGO (8kB antes). Tienen un gran nivel de detalle en un tamaño comedido. La decisión de cuántos triángulos usar depende mucho del tipo de imagen (por ejemplo contraste, cantidad de colores, complejidad de la forma) y el nivel de detalle deseado.</p><p>Sería posible crear un script similar a <a href=https://github.com/technopagan/cjpeg-dssim target=_blank rel=noopener>cpeg-dssim</a> que ajusta la cantidad de formas hasta llegar a un umbral de <a href=https://en.wikipedia.org/wiki/Structural_similarity target=_blank rel=noopener>similaridad estructural</a>, o un máximo número de formas en el peor caso.</p><p>Los SVGs resultantes son una buena opción también como imágenes de fondo. Dado que son vectoriales y tienen un tamaño limitado, son un buen candidato para imágenes <em>hero</em> y fondos de gran tamaño que de otro modo mostrarían artefactos de compresión.</p><h4 id=SQIP><a href=#SQIP class=headerlink title=SQIP></a>SQIP</h4><p>En <a href=https://github.com/technopagan/sqip target=_blank rel=noopener>palabras de Tobias</a>:</p><blockquote><p>SQIP es un intento de encontrar un balance entre estos dos extremos: hace uso de <a href=https://github.com/fogleman/primitive target=_blank rel=noopener>Primitive</a> para generar un SVG consistente en varias formas sencillas que aproximan las principales características visibles dentro de la imagen, optimiza el SVG utilizando <a href=https://github.com/svg/svgo target=_blank rel=noopener>SVGO</a> y le añade un filtro de desenfoque gaussiano. Esto produce un placeholder SVG que pesa sólo ~800–1000 bytes, se ve bien en todas las pantallas y proporciona una pista visual del contenido de la imagen que se va a cargar.</p></blockquote><p>El resultado es similar a utilizar una imagen pequeña como placeholder en la técnica blur-up (lo que <a href=/medium-image-progressive-loading-placeholder>Medium</a> y <a href=/more-progressive-image-loading>otros sitios</a> hacen). La diferencia es que, en lugar de utilizar una imagen bitmap como JPG o WebP, el placeholder usa SVG.</p><p>Si ejecutamos SQIP con las imágenes originales obtenemos esto:</p><div><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:342,f_auto,c_scale,w_670/v1509370309/pexels-photo-281184-square-sqip.svg_zspgb0.png sizes="(max-width: 768px) 50vw, 342px" alt="SQIP aplicado a una imagen" style=width:49%;float:left;margin-right:2%;padding-bottom:10px><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto:100:342,f_auto,c_scale,w_670/v1509370308/pexels-photo-618463-square-sqip.svg_qjrexh.png sizes="(max-width: 768px) 50vw, 342px" alt="SQIP aplicado a una imagen" style=width:49%;float:left;padding-bottom:10px></div><p><small class=caption>Las imágenes resultantes tras aplicar SQIP sobre <a href=/assets/images/posts/svg-placeholders/pexels-photo-281184-square-sqip.svg>la primera imagen</a> y <a href=/assets/images/posts/svg-placeholders/pexels-photo-618463-square-sqip.svg>la segunda</a>.</small></p><p>El SVG resultante ocupa ~900 bytes. Inspeccionando el código podemos observar el filtro <code>feGaussianBlur</code> aplicado al grupo de formas:</p><div class=code-wrap><figure class="highlight html"><table><tr><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>svg</span> <span class=attr>xmlns</span>=<span class=string>"http://www.w3.org/2000/svg"</span> <span class=attr>viewBox</span>=<span class=string>"0 0 2000 2000"</span>&gt;</span><span class=tag>&lt;<span class=name>filter</span> <span class=attr>id</span>=<span class=string>"b"</span>&gt;</span><span class=tag>&lt;<span class=name>feGaussianBlur</span> <span class=attr>stdDeviation</span>=<span class=string>"12"</span> /&gt;</span><span class=tag>&lt;/<span class=name>filter</span>&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#817c70"</span> <span class=attr>d</span>=<span class=string>"M0 0h2000v2000H0z"</span>/&gt;</span><span class=tag>&lt;<span class=name>g</span> <span class=attr>filter</span>=<span class=string>"url(#b)"</span> <span class=attr>transform</span>=<span class=string>"translate(4 4) scale(7.8125)"</span> <span class=attr>fill-opacity</span>=<span class=string>".5"</span>&gt;</span><span class=tag>&lt;<span class=name>ellipse</span> <span class=attr>fill</span>=<span class=string>"#000210"</span> <span class=attr>rx</span>=<span class=string>"1"</span> <span class=attr>ry</span>=<span class=string>"1"</span> <span class=attr>transform</span>=<span class=string>"matrix(50.41098 -3.7951 11.14787 148.07886 107 194.6)"</span>/&gt;</span><span class=tag>&lt;<span class=name>ellipse</span> <span class=attr>fill</span>=<span class=string>"#eee3bb"</span> <span class=attr>rx</span>=<span class=string>"1"</span> <span class=attr>ry</span>=<span class=string>"1"</span> <span class=attr>transform</span>=<span class=string>"matrix(-56.38179 17.684 -24.48514 -78.06584 205 110.1)"</span>/&gt;</span><span class=tag>&lt;<span class=name>ellipse</span> <span class=attr>fill</span>=<span class=string>"#fff4bd"</span> <span class=attr>rx</span>=<span class=string>"1"</span> <span class=attr>ry</span>=<span class=string>"1"</span> <span class=attr>transform</span>=<span class=string>"matrix(35.40604 -5.49219 14.85017 95.73337 16.4 123.6)"</span>/&gt;</span><span class=tag>&lt;<span class=name>ellipse</span> <span class=attr>fill</span>=<span class=string>"#79c7db"</span> <span class=attr>cx</span>=<span class=string>"21"</span> <span class=attr>cy</span>=<span class=string>"39"</span> <span class=attr>rx</span>=<span class=string>"65"</span> <span class=attr>ry</span>=<span class=string>"65"</span>/&gt;</span><span class=tag>&lt;<span class=name>ellipse</span> <span class=attr>fill</span>=<span class=string>"#0c1320"</span> <span class=attr>cx</span>=<span class=string>"117"</span> <span class=attr>cy</span>=<span class=string>"38"</span> <span class=attr>rx</span>=<span class=string>"34"</span> <span class=attr>ry</span>=<span class=string>"47"</span>/&gt;</span><span class=tag>&lt;<span class=name>ellipse</span> <span class=attr>fill</span>=<span class=string>"#5cb0cd"</span> <span class=attr>rx</span>=<span class=string>"1"</span> <span class=attr>ry</span>=<span class=string>"1"</span> <span class=attr>transform</span>=<span class=string>"matrix(-39.46201 77.24476 -54.56092 -27.87353 219.2 7.9)"</span>/&gt;</span><span class=tag>&lt;<span class=name>path</span> <span class=attr>fill</span>=<span class=string>"#e57339"</span> <span class=attr>d</span>=<span class=string>"M271 159l-123-16 43 128z"</span>/&gt;</span><span class=tag>&lt;<span class=name>ellipse</span> <span class=attr>fill</span>=<span class=string>"#47332f"</span> <span class=attr>cx</span>=<span class=string>"214"</span> <span class=attr>cy</span>=<span class=string>"237"</span> <span class=attr>rx</span>=<span class=string>"242"</span> <span class=attr>ry</span>=<span class=string>"19"</span>/&gt;</span><span class=tag>&lt;/<span class=name>g</span>&gt;</span><span class=tag>&lt;/<span class=name>svg</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p>SQIP también puede imprimir como resultado una etiqueta <code>img</code> con el contenido del SVG codificado en Base 64:</p><div class=code-wrap><figure class="highlight html"><table><tr><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>img</span> <span class=attr>width</span>=<span class=string>"640"</span> <span class=attr>height</span>=<span class=string>"640"</span> <span class=attr>src</span>=<span class=string>"example.jpg"</span> <span class=attr>alt</span>=<span class=string>"Add descriptive alt text"</span> <span class=attr>style</span>=<span class=string>"background-size: cover; background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAw...&lt;stripped base 64&gt;...PjwvZz48L3N2Zz4=);"</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h4 id=Siluetas><a href=#Siluetas class=headerlink title=Siluetas></a>Siluetas</h4><p>Acabamos de ver cómo usar SVGs para contornos y formas básicas. Otra posibilidad es vectorizar las imágenes “trazándolas”. <a href=https://twitter.com/mikaelainalem target=_blank rel=noopener>Mikael Ainalem</a> compartió <a href="https://codepen.io/ainalem/full/aLKxjm/" target=_blank rel=noopener>un codepen</a> hace unos días mostrando cómo usar una silueta con 2 colores como placeholder. El resultado es muy bonito:</p><video controls style=max-width:100% width=690 height=459><source src=https://res.cloudinary.com/jmperez/video/upload/dpr_auto,f_auto,q_auto,c_scale/v1509278615/silhouette-lazy-loading_evq9xq.mp4 type=video/mp4></source></video><p>En este caso los SVGs están dibujados a mano, pero la técnica inspiró rápidamente a desarrolladores que crearon integraciones con herramientas que automatizaban el proceso.</p><ul><li><a href=https://www.gatsbyjs.org target=_blank rel=noopener>Gatsby</a>, un generador de sitios estáticos basado en React, soporta estos SVGs trazados. Utiliza <a href=https://www.npmjs.com/package/potrace target=_blank rel=noopener>un port de potrace a JavaScript</a> para vectorizar las imágenes.</li></ul><blockquote class=twitter-tweet data-lang=en-gb><p lang=en dir=ltr>Excited to announce that Gatsby now has super simple support for traced SVG!<br><br>Thanks to <a href="https://twitter.com/fk?ref_src=twsrc%5Etfw" target=_blank rel=noopener>@fk</a> for his great work!<a href=https://t.co/XfgEDbSILA target=_blank rel=noopener>https://t.co/XfgEDbSILA</a> <a href=https://t.co/wTwOgT8C5V target=_blank rel=noopener>pic.twitter.com/wTwOgT8C5V</a></p>&mdash; Gatsby (@gatsbyjs) <a href="https://twitter.com/gatsbyjs/status/923304195666485248?ref_src=twsrc%5Etfw" target=_blank rel=noopener>25 October 2017</a></blockquote><ul><li><a href=https://craftcms.com target=_blank rel=noopener>Craft 3 CMS</a>, que también añadió soporte para siluetas. Utiliza <a href=https://github.com/nystudio107/craft3-imageoptimize/blob/master/src/lib/Potracio.php target=_blank rel=noopener>un port de potrace a PHP</a>.</li></ul><blockquote class=twitter-tweet data-lang=en-gb><p lang=en dir=ltr>Cool video of using inline SVG images as lazy loading placeholders w/ ImageOptimize &amp; Craft 3 from <a href="https://twitter.com/slebbo?ref_src=twsrc%5Etfw" target=_blank rel=noopener>@slebbo</a> <a href=https://t.co/E1dYA4ayow target=_blank rel=noopener>https://t.co/E1dYA4ayow</a> <a href="https://twitter.com/hashtag/craftcms?src=hash&amp;ref_src=twsrc%5Etfw" target=_blank rel=noopener>#craftcms</a> <a href=https://t.co/ruf8i6URCT target=_blank rel=noopener>pic.twitter.com/ruf8i6URCT</a></p>&mdash; nystudio107 (@nystudio107) <a href="https://twitter.com/nystudio107/status/920673966091534338?ref_src=twsrc%5Etfw" target=_blank rel=noopener>18 October 2017</a></blockquote><ul><li><a href=https://github.com/EmilTholin/image-trace-loader target=_blank rel=noopener>image-trace-loader</a>, un loader de Webpack que utiliza potrace para procesar las imágenes.</li></ul><blockquote class=twitter-tweet data-lang=en-gb><p lang=en dir=ltr>I just released image-trace-loader, a <a href="https://twitter.com/hashtag/webpack?src=hash&amp;ref_src=twsrc%5Etfw" target=_blank rel=noopener>#webpack</a> loader that exports traced outlines as image/svg+xml data.<a href=https://t.co/2VZaKVaE4p target=_blank rel=noopener>https://t.co/2VZaKVaE4p</a> <a href=https://t.co/vRma67R7zb target=_blank rel=noopener>pic.twitter.com/vRma67R7zb</a></p>&mdash; Emil Tholin (@Tholle1234) <a href="https://twitter.com/Tholle1234/status/920423596346019840?ref_src=twsrc%5Etfw" target=_blank rel=noopener>17 October 2017</a></blockquote><p>También es interesante ver una comparación de la salida obtenida por el loader de webpack de Emil (basado en potrace) y los SVGs dibujados a mano de Mikael.</p><blockquote class=twitter-tweet data-lang=en-gb><p lang=en dir=ltr>Comparison of <a href="https://twitter.com/mikaelainalem?ref_src=twsrc%5Etfw" target=_blank rel=noopener>@mikaelainalem</a> &#39;s SVG lazy-loading technique <a href=https://t.co/mbqVpxzn72 target=_blank rel=noopener>https://t.co/mbqVpxzn72</a> with @Tholle123&#39;s webpack loader <a href=https://t.co/3jxjtNP8dm target=_blank rel=noopener>https://t.co/3jxjtNP8dm</a> <a href=https://t.co/tChcPK0mIK target=_blank rel=noopener>pic.twitter.com/tChcPK0mIK</a></p>&mdash; Yuriy Nemtsov (@nemtsovy) <a href="https://twitter.com/nemtsovy/status/920647706799955970?ref_src=twsrc%5Etfw" target=_blank rel=noopener>18 October 2017</a></blockquote><p>Asumo que la salida generada por potrace utiliza las opciones por defecto. Adicionalmente, es posible ajustarlas. Lee <a href=https://github.com/EmilTholin/image-trace-loader#options target=_blank rel=noopener>las opciones para image-trace-loader</a>, que son prácticamente <a href=https://www.npmjs.com/package/potrace#parameters target=_blank rel=noopener>las que se pasan a potrace</a>.</p><h2 id=Resumen><a href=#Resumen class=headerlink title=Resumen></a>Resumen</h2><p>Hemos visto diferentes herramientas y técnicas para generar SVGs basados en imágenes bitmap y utilizarlos como placeholders. De la misma forma que <a href="/webp-placeholder-images/">WebP es un formato fantástico para previsualizaciones</a>, SVG es también un formato interesante para aplicar en los placeholders. Podemos controlar el nivel de detalle (y por consiguiente, su tamaño), es altamente comprimible y es fácil de manipular con CSS y JS.</p><h2 id=Recursos-extra><a href=#Recursos-extra class=headerlink title="Recursos extra"></a>Recursos extra</h2><p>Este post llegó a <a href="https://news.ycombinator.com/item?id=15696596" target=_blank rel=noopener>lo alto de Hacker News, consiguiendo muchos puntos y comentarios</a>. Me siento orgulloso por ello, y por todos los enlaces a otros recursos que han sido compartidos en los comentarios de esa página. Aquí tienes algunos de ellos:</p><ul><li><a href=https://github.com/Tw1ddle/geometrize-haxe target=_blank rel=noopener>Geometrize</a> es un port de Primitive escrito en Haxe. También hay <a href=https://github.com/Tw1ddle/geometrize-haxe-web target=_blank rel=noopener>una implementación en JavaScript</a> que puedes probar directamente <a href="http://www.samcodes.co.uk/project/geometrize-haxe-web/" target=_blank rel=noopener>en tu navegador</a>.</li><li><a href=https://github.com/ondras/primitive.js target=_blank rel=noopener>Primitive.js</a>, que es un port de Primitive en JavaScript. También, <a href=https://github.com/cielito-lindo-productions/primitive.nextgen target=_blank rel=noopener>primitive.nextgen</a>, que es un port de la aplicación de escritorio de Primitive utilizando Primitive.js y Electron.</li><li>Hay un par de cuentas de Twitter donde puedes ver ejemplos de imágenes generadas con Primitive y Geometrize: <a href=https://twitter.com/PrimitivePic target=_blank rel=noopener>@PrimitivePic</a> y <a href=https://twitter.com/Geometrizer target=_blank rel=noopener>@Geometrizer</a>.</li><li><a href=https://github.com/jankovicsandras/imagetracerjs target=_blank rel=noopener>imagetracerjs</a>, que es un tracer de imágenes ráster y vectorizador escrito en JavaScript. También hay ports para <a href=https://github.com/jankovicsandras/imagetracerjava target=_blank rel=noopener>Java</a> y <a href=https://github.com/jankovicsandras/imagetracerandroid target=_blank rel=noopener>Android</a>.</li></ul><h2 id=Posts-relacionados><a href=#Posts-relacionados class=headerlink title="Posts relacionados"></a>Posts relacionados</h2><p>Si te ha gustado este post, echa un vistazo a estos otros en los que he escrito sobre técnicas para cargar imágenes:</p><ul><li><a href=/medium-image-progressive-loading-placeholder>Cómo Medium carga imágenes de forma progresiva</a></li><li><a href=/webp-placeholder-images>Usando WebP para crear pequeñas previsualizaciones</a></li><li><a href=/more-progressive-image-loading>Más ejemplos de carga de imágenes progresiva</a></li></ul><script async src=https://platform.twitter.com/widgets.js charset=utf-8></script></div><hr/></article></div><script>"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js").then(function(n){})["catch"](function(n){})});</script><footer><section class=links><a href=https://twitter.com/jmperezperez>@jmperezperez</a> on Twitter · <a href=https://github.com/JMPerez>GitHub</a> · <a href=http://www.linkedin.com/in/jmperezperez>LinkedIn</a></section><div class=timing-stats></div></footer><script>window.addEventListener('load', () => {
     setTimeout(() => {
      var t = window.performance && performance.timing;
      function round2(num) { return Math.round(num * 100) / 100; }
      if (t) {
          var timingStats = document.querySelector('.timing-stats');
          var loadTime = (t.loadEventEnd - t.navigationStart) / 1000;
          var timingStatsHTML = 'This page loaded in ' + round2(loadTime) + ' seconds. ';
          var performanceEntries = performance.getEntriesByType('paint');
          performanceEntries.forEach(function(performanceEntry, i, entries) {
            var name = performanceEntry.name;
            if (name === 'first-paint') {
              name = '<abbr title=' + name + '>FP</abbr>';
            } else if (name === 'first-contentful-paint') {
              name = '<abbr title=' + name + '>FCP</abbr>';
            }
            timingStatsHTML += name + ' was ' + round2(performanceEntry.startTime / 1000) + ' seconds. ';
          });
          timingStats.innerHTML = timingStatsHTML;
      }
    }, 0);
   });</script></body></html>