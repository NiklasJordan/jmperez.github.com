<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta http-equiv=Accept-CH content="DPR, Viewport-Width, Width"><title>Updates on BigPipe using ASP.NET MVC - JMPerez Blog</title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover"><link rel=author href="https://plus.google.com/107456024651797783420"/><link rel=alternate type=application/rss+xml title="Jose M. Perez" href=https://jmperezperez.com/feed.xml><meta name=twitter:card content=summary><meta name=twitter:url content="https://jmperezperez.com/updates-on-bigpipe-using-asp-net-mvc/" property=og:url><meta name=twitter:title content="Updates on BigPipe using ASP.NET MVC" property=og:title><meta name=twitter:site content=@jmperezperez><meta property=fb:app_id content=1702266270006013><meta property=fb:pages content="1639848659664211"/><link rel=canonical href="https://jmperezperez.com/updates-on-bigpipe-using-asp-net-mvc/"/><style>a,a:hover{color:#2a7cb2}.post::after,hr{display:block;clear:both}#page,.main-header,.videoWrapper{position:relative}.code,code,pre{letter-spacing:0}.caption,.intro-blog,.main-header,.pagination,.pagination a,footer{text-align:center}*{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;border:none;font:inherit;margin:0;padding:0;vertical-align:baseline}button,input{background:0 0}body{background:#fff;color:#555;font-family:Georgia,Times;font-weight:300;font-style:normal;font-size:19px;line-height:1.725;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-text-size-adjust:100%}blockquote,em{font-style:italic}@media(max-width:800px){body{font-size:17px}}@media(max-width:600px){body{font-size:15px}}h1,h2,h3,h4,h5{color:#212121;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:600;font-size:1em;line-height:1.3;margin-bottom:1em}h2,h3,h4,h5{margin-top:2em}#menu a,.button{font-weight:400}.post ol,.post ul,amp-video,amp-vimeo,amp-youtube,iframe,p,video{margin:0 0 1em}.quote,blockquote,ol,ul{margin:0 0 15px}twitterwidget{margin-bottom:1em!important}a{font-weight:inherit;text-decoration:none;transition:color .15s ease-out,border-bottom-color .15s ease-out}p a{border-bottom:1px solid #eee}p a:hover{border-bottom-color:#212121}strong{font-weight:700}h2,h3{font-weight:400}h1{font-size:1.7em}h2{color:#444;font-size:1.6em}h3{color:#666;font-size:1.4em}#menu a[aria-current],.intro-blog{font-weight:700}h4{font-size:1.18em}h5{font-size:1em}a h1,a h2,a h3,a h4,a h5{transition:color .15s ease-out}a:hover h1,a:hover h2,a:hover h3,a:hover h4,a:hover h5{color:#3498db}blockquote{border-left:2px solid #ccc;padding-left:20px}ol,ul{padding-left:25px}ul{list-style:square}ol{list-style:decimal}hr{background:#eee;color:#eee;height:2px;margin:30px auto;width:50%}.main-header,.post,.post .svg-container object{width:100%}code,pre{color:#333;font-family:Courier,Menlo,Monaco;font-size:.8em;overflow-x:auto}.author,.intro-blog,.main-header{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}pre{padding:.8em 1em}code{margin:0}.post::after{content:''}.main-header{background-color:#005689;overflow:hidden;padding:1em}#menu{display:inline-block;margin:1px 0}#menu a{color:#fff;font-size:14px;margin-left:15px;padding:20px 10px;text-transform:uppercase}@media(max-width:500px){#menu a{margin-left:10px;padding:10px 5px}}#menu a:first-child{margin-left:0}#page{margin:0 auto;max-width:40em;padding:3em 2em}.videoWrapper{height:0;margin-bottom:1em;padding-bottom:56.25%;padding-top:25px}.videoWrapper amp-youtube,.videoWrapper iframe{height:100%;left:0;position:absolute;top:0;width:100%}.wrapper{border-top:2px solid #eee;padding:3em 0}.wrapper:first-child{border-top:none;padding-top:5%}.posts-list h2{margin-top:0}.post{display:block}.post div[itemprop=articleBody]>p:first-child{color:#333}.post li{margin-bottom:.5em}.post p img{border:1px solid #eee;display:block;max-width:100%}.post img+.caption{padding-top:5px}.post .svg-container{margin-bottom:5%;max-width:100%;text-align:center}video{height:auto;max-width:100%}.pagination a{min-width:30px;max-height:30px}footer{background:rgba(0,0,0,.05);padding:2em}.button{background-color:#fff;border:1px solid #555;border-radius:20px;color:#555;display:inline-block;font-size:13px;line-height:10px;padding:10px 20px;transition:background-color .15s ease-out}.button:hover{background-color:#3498db;border-color:transparent;color:#fff}.button.inactive{background-color:#ccc;color:#fff}.search-goog input{border:2px solid #ddd;padding:10px}.search-goog input[type=submit]{background-color:#ddd;cursor:pointer}@media only screen and (max-width:768px){#page,.wrapper{margin:0;max-width:100%;padding:1.5em;width:100%}.wrapper{padding:10% 0}.wraper::after{clear:both;content:'';display:block}.post{margin:0 auto;max-width:640px}}.outscreen{height:1px;left:-1000px;overflow:hidden;position:absolute;top:auto;width:1px}.callout{border:1px solid #eee;border-left-color:#777;border-left-width:5px;border-radius:3px;font-size:90%;padding:20px;margin:20px 0}.author{font-size:.8em;margin-bottom:2em}.author .name{line-height:1.5;padding-top:.35em}.bd,.media{overflow:hidden;zoom:1}.media .img{float:left}.avatar-img{border-radius:100%;height:3.5em;margin-right:.5em;width:3.5em}.highlight{border:1px solid #eee;margin-bottom:1em;overflow-x:auto}.code{background:#fff;color:#333;display:block;overflow-x:auto}.code .comment,.code .meta{color:#969896}.code .emphasis,.code .quote,.code .string,.code .strong,.code .template-variable,.code .variable{color:#df5000}.code .keyword,.code .selector-tag,.code .type{color:#a71d5d}.code .attribute,.code .bullet,.code .literal,.code .symbol{color:#0086b3}.code .name,.code .section{color:#63a35c}.code .tag{color:#333}.code .attr,.code .selector-attr,.code .selector-class,.code .selector-id,.code .selector-pseudo,.code .title{color:#795da3}.code .addition{background-color:#eaffea;color:#55a532}.code .deletion{background-color:#ffecec;color:#bd2c00}.code .link{text-decoration:underline}.code-wrap pre{white-space:pre-wrap}.caption{display:block;font-size:.8em}.codepen-aspect-ratio>iframe{height:100%;position:absolute;width:100%}.twitter-tweet{margin-left:auto;margin-right:auto}.twitter-tweet::after{content:"";display:block;padding-bottom:20px;width:100%}.intro-blog{font-size:1.5em;line-height:1.3;margin:2em auto;max-width:640px}</style><link rel=amphtml href="/updates-on-bigpipe-using-asp-net-mvc/amp/"><meta name=theme-color content=#005689><link rel=manifest href=/manifest.json></head><body><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-39254352-1","auto"),ga("send","pageview");</script><header class=main-header><nav id=menu><a href="/">Blog</a> <a href="/projects/">Projects</a> <a href="/talks/">Speaking</a> <a href="/about-me/">About</a></nav></header><div id=page><article class=wrapper><div class=post><header><script type=application/ld+json>{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Updates on BigPipe using ASP.NET MVC",
  
  "description": "<p>It’s been several weeks since I wrote <a href="/tutorial-how-to-implement-bigpipe-using-asp-net-mvc-part-1">a tutorial to implement BigPipe using C# and ASP.Net MVC</a>. And I have just read <a href="http://velocity.oreilly.com.cn/index.php?func=session&amp;name=Facebook%E7%BD%91%E7%AB%99%E7%9A%84Ajax%E5%8C%96%E3%80%81%E7%BC%93%E5%AD%98%E5%92%8C%E6%B5%81%E6%B0%B4%E7%BA%BF" target="_blank" rel="noopener">a PDF from a presentation at Velocity China</a> in which Changhao Jiang, from Facebook, explains some details about Bigpipe, as well as other techniques they use to improve Time to interact (both real and perceived), as well as data savings. These techniques (named Quickling and PageCache) are based on hijax and an intelligent update of specific content of the page instead of the whole page when data changes.</p>",
  
  "mainEntityOfPage":{
      "@type":"WebPage",
      "@id":"https://jmperezperez.com/updates-on-bigpipe-using-asp-net-mvc/"
  },
  "datePublished": "2010-12-11T16:17:14.000Z",
  "dateModified": "2018-01-04T11:39:58.000Z",
  
  "author": {
      "@type": "Person",
      "name": "Jose M. Perez"
  },
  "publisher": {
      "@type": "Organization",
      "name": "Jose M. Perez's Blog"
      
      ,
      "logo": {
        "@type": "ImageObject",
        "url": "https://jmperezperez.com/assets/images/logo.png",
        "width": 600,
        "height": 60
      }
      
  }
}</script><div class="media author"><div class=img><a href="/about-me/"><img src=https://res.cloudinary.com/jmperez/image/upload/w_auto,f_auto,c_scale/v1510494899/jmperez_ogpkt5.jpg class=avatar-img alt="" height=53 width=53 sizes=53px></a></div><div class=bd><address class=name itemprop=author itemscope itemtype=https://schema.org/Person><a href="/about-me/" itemprop=name>José M. Pérez</a></address><meta class=post-data itemprop=datePublished content=2010-12-11T16:17:14.000Z>December 11 2010</div></div><h1>Updates on BigPipe using ASP.NET MVC</h1></header><p>It’s been several weeks since I wrote <a href=/tutorial-how-to-implement-bigpipe-using-asp-net-mvc-part-1>a tutorial to implement BigPipe using C# and ASP.Net MVC</a>. And I have just read <a href="http://velocity.oreilly.com.cn/index.php?func=session&amp;name=Facebook%E7%BD%91%E7%AB%99%E7%9A%84Ajax%E5%8C%96%E3%80%81%E7%BC%93%E5%AD%98%E5%92%8C%E6%B5%81%E6%B0%B4%E7%BA%BF" target=_blank rel=noopener>a PDF from a presentation at Velocity China</a> in which Changhao Jiang, from Facebook, explains some details about Bigpipe, as well as other techniques they use to improve Time to interact (both real and perceived), as well as data savings. These techniques (named Quickling and PageCache) are based on hijax and an intelligent update of specific content of the page instead of the whole page when data changes.</p><a id=more></a><p>According to Changhao Jiang, this is the improvement when using BigPipe on Facebook: <img src=/assets/images/posts/bigpipe-tti-improvement-e1320910397828.png alt="Improvement when using BigPipe on Facebook"></p><p>My first project using BigPipe as I explained is about to go online. Overall I can say that BigPipe approach has helped divide pages into independent chunks using RenderAction, opposite to overpopulating a single action to retrieve all data needed by the page. And I have faced some problems involving pagelet content.</p><p>##HTML to JSON When using JavascriptSerializer (or JsonResult) to convert HTML content to JSON, the generated code is not as nice as Facebook’s.</p><p>While yours will look similar to<figure class="highlight js"><table><tr><td class=code><pre><span class=line>bigpipe.onPageletArrive(&#123;<span class=string>"Id"</span>:<span class=string>"my-pagelet"</span>,<span class=string>"Content"</span>:<span class=string>"\\r\n\r\n\u003cdiv class=\"my-div\"\u003e\r\n    \u003c ...</span></span><br></pre></td></tr></table></figure></p><p>Facebook’s is more like this:<figure class="highlight js"><table><tr><td class=code><pre><span class=line>bigpipe.onPageletArrive(&#123;<span class=string>"Id"</span>:<span class=string>"my-pagelet"</span>,<span class=string>"Content"</span>:<span class=string>"&lt;div class=\"my-div\"&gt; ...</span></span><br></pre></td></tr></table></figure></p><p>So (1) it can be a good idea to strip whitespace from your code and (2) maybe you would like to replace those \u003c and \u003e (see <a href=http://stackoverflow.com/questions/1058895/cant-get-to-show-up-in-json-string target=_blank rel=noopener>this discussion at stackoverflow</a> and <a href=http://forums.asp.net/t/1440943.aspx target=_blank rel=noopener>this other link</a>).</p><p>##Javascript code not being executed when appended to document using ajax If your pagelet contains Javascript code, you’d better off moving it from the content of the pagelet to a javascript file to be downloaded and executed as I explain in the tutorial. When you append the content of the pagelet to the container, its Javascript code will not be executed, so take this into account.</p><p>In the next days I will update the code of the tutorial to include minor changes that I have found can improve it. And when I have more information about how my little bigpipe is performing I will write a post about it.</p></div><hr/></article></div><script>"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js").then(function(n){})["catch"](function(n){})});</script><footer><section class=links><a href=https://twitter.com/jmperezperez>@jmperezperez</a> on Twitter · <a href=https://github.com/JMPerez>GitHub</a> · <a href=http://www.linkedin.com/in/jmperezperez>LinkedIn</a></section></footer></body></html>